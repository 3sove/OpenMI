<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>OATC OpenMI Editor 2.0</title><link rel="stylesheet" href="OpenMI.css" type="text/css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.75.1"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="book" title="OATC OpenMI Editor 2.0"><div class="titlepage"><div><div><h1 class="title"><a name="d0e1"></a>OATC OpenMI Editor 2.0</h1></div><div><div class="author"><h3 class="author"><span class="firstname">Adrian</span> <span class="surname">Harper</span></h3><div class="affiliation"><span class="orgname">OpenMI Association Technical Committee<br></span></div></div></div><div><p class="pubdate">January 2010</p></div></div><hr></div><div class="toc"><dl><dt><span class="chapter"><a href="#d0e16">1. Overview</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e19">1. Why it exists</a></span></dt><dt><span class="section"><a href="#d0e38">2. What it cannot do</a></span></dt><dt><span class="section"><a href="#d0e47">3. Where to get it</a></span></dt></dl></dd><dt><span class="chapter"><a href="#d0e68">2. Tutorials</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e71">1. Quick Start</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e83">1.1. Basic Application and Help</a></span></dt><dt><span class="section"><a href="#d0e102">1.2. Adding Models</a></span></dt><dt><span class="section"><a href="#d0e162">1.3. Adding a Connection</a></span></dt><dt><span class="section"><a href="#d0e185">1.4. Editing Links</a></span></dt><dt><span class="section"><a href="#d0e214">1.5. Saving Compositions</a></span></dt><dt><span class="section"><a href="#d0e227">1.6. Running Compositions</a></span></dt></dl></dd><dt><span class="section"><a href="#d0e318">2. Adapted sources</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e401">2.1. Third party factories</a></span></dt></dl></dd><dt><span class="section"><a href="#d0e408">3. Examples</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e475">3.1. One river reach</a></span></dt><dt><span class="section"><a href="#d0e520">3.2. Two river reaches</a></span></dt><dt><span class="section"><a href="#d0e563">3.3. Two reaches + 1 adapter</a></span></dt><dt><span class="section"><a href="#d0e584">3.4. Two reaches + 2 adapters</a></span></dt></dl></dd></dl></dd></dl></div><div class="chapter" title="Chapter&nbsp;1.&nbsp;Overview"><div class="titlepage"><div><div><h2 class="title"><a name="d0e16"></a>Chapter&nbsp;1.&nbsp;Overview</h2></div></div></div><div class="section" title="1.&nbsp;Why it exists"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e19"></a>1.&nbsp;Why it exists</h2></div></div></div><p>The &#8220;OpenMI Association&#8221; is responsible for the OpenMI standard. However, it also commits to providing an open source user interface (UI) that is easily obtainable. It is not intended that this UI be &#8220;complex&#8221; or &#8220;advanced&#8221;, its primary goals are</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Provide a simple demonstration of OpenMI functionality</p></li><li class="listitem"><p>Allow a basic means of connection and running OpenMI components interactively</p></li><li class="listitem"><p>Minimize complexity of maintenance e.g. Make bug fixing as simple as possible by anyone</p></li></ul></div><p>The association assumes, and indeed actively supports, the development of 3rd party editors that provide advanced or more specialized functionality. The development of this UI is managed by the "OpenMI Association Technical Committee" (OATC).</p><p>However, whenever a new version of the standard is released (or proposed) then this editor is the simplest way of demonstrating and providing examples of any new features.</p></div><div class="section" title="2.&nbsp;What it cannot do"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e38"></a>2.&nbsp;What it cannot do</h2></div></div></div><p>It can only run compositions where all models implement the pull approach</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>i.e ILinkableComponent.CascadingUpdateCallsDisabled = false</p></li></ul></div></div><div class="section" title="3.&nbsp;Where to get it"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e47"></a>3.&nbsp;Where to get it</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The OpenMI Association web site <a class="link" href="http://www.openmi.org" target="_top">http://www.openmi.org</a> will provide an link to where it can be downloaded.</p></li><li class="listitem"><p>As it is open source, the installers and code can de downloaded from the Source Forge web site<a class="link" href="http://sourceforge.net/projects/openmi/" target="_top">http://sourceforge.net/projects/openmi/</a></p></li><li class="listitem"><p>Additional up to date information can also be found on the OpenMI Association Technical Committee Wiki at <a class="link" href="http://wiki.openmi.org" target="_top">http://wiki.openmi.org</a></p></li></ul></div></div></div><div class="chapter" title="Chapter&nbsp;2.&nbsp;Tutorials"><div class="titlepage"><div><div><h2 class="title"><a name="d0e68"></a>Chapter&nbsp;2.&nbsp;Tutorials</h2></div></div></div><div class="section" title="1.&nbsp;Quick Start"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e71"></a>1.&nbsp;Quick Start</h2></div></div></div><p>This section provides a quick example of building a simple composition and running it. It is intended for people</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Who have used and know version 1.0 and wish to quickly get acquainted with new features</p></li><li class="listitem"><p>Who want to run an example as quickly as possible to check their implementation works as expected</p></li></ul></div><div class="section" title="1.1.&nbsp;Basic Application and Help"><div class="titlepage"><div><div><h3 class="title"><a name="d0e83"></a>1.1.&nbsp;Basic Application and Help</h3></div></div></div><div class="figure"><a name="d0e86"></a><p class="title"><b>Figure&nbsp;2.1.&nbsp;Basic Application</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_app_helpmenu.png" alt="Basic Application"></div></div></div><br class="figure-break"><p>The basic application should appear as above. The latest version of this document can be obtained from the help menu [F1]. The "Wiki ..." menu item will send a URI for the OpenMI OATC Wiki pages to the default Internet browser.</p><div class="figure"><a name="d0e94"></a><p class="title"><b>Figure&nbsp;2.2.&nbsp;Wiki Pages</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_wikipages.png" alt="Wiki Pages"></div></div></div><br class="figure-break"><p>"About ..." provides release information about this application e.g. EULA and current release version number.</p></div><div class="section" title="1.2.&nbsp;Adding Models"><div class="titlepage"><div><div><h3 class="title"><a name="d0e102"></a>1.2.&nbsp;Adding Models</h3></div></div></div><p>Either via main menu</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Composition</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>Add Model(s) ...</p></li></ul></div></li></ul></div><p>Or right click mouse within panel for context menu as follows</p><div class="figure"><a name="d0e117"></a><p class="title"><b>Figure&nbsp;2.3.&nbsp;Context Menu</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_contextaddmodels.png" alt="Context Menu"></div></div></div><br class="figure-break"><p>Which brings up a Open file dialog. Search for and select OpenMI models (typically files with 'omi' file extension)</p><div class="figure"><a name="d0e125"></a><p class="title"><b>Figure&nbsp;2.4.&nbsp;Add Model(s) Dialog</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_addmodelsdlg.png" alt="Add Model(s) Dialog"></div></div></div><br class="figure-break"><p>If the files contain valid OpenMI XML and all the underlying dll's are visible. Something like the following should appear</p><div class="figure"><a name="d0e133"></a><p class="title"><b>Figure&nbsp;2.5.&nbsp;Loaded Models</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_addedmodels.png" alt="Loaded Models"></div></div></div><br class="figure-break"><p>In this example, two OMI files were selected and loaded together. The last loaded model will appear blue, and all others appear yellow. Blue indicates the model within the composition that is connected to the trigger, i.e. the model that will drive the composition using the pull driven approach. Only one model within a composition can have a trigger, to change this use the main menu</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Composition</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>Attach Trigger ...</p></li></ul></div></li></ul></div><p>Which then allows the user to select a model to move the trigger too. Alternatively, select a model first and use the right click context menu item "Attach Trigger ..."</p><div class="figure"><a name="d0e151"></a><p class="title"><b>Figure&nbsp;2.6.&nbsp;Attach Trigger</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_attachtrigger.png" alt="Attach Trigger"></div></div></div><br class="figure-break"><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>In version 1 the trigger was a separate blue rectangle on the display. In version 2 we have combined the trigger with the model to which it is attached and turned that model blue.</p></div><p>Models can be moved around the screen by holding down the left mouse button over a model and dragging the mouse to a new location.</p></div><div class="section" title="1.3.&nbsp;Adding a Connection"><div class="titlepage"><div><div><h3 class="title"><a name="d0e162"></a>1.3.&nbsp;Adding a Connection</h3></div></div></div><p>Either use main menu</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Composition</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>Add Connection ...</p></li></ul></div></li></ul></div><p>Which will require the user to select the source model followed by the target model. Or use the corresponding men item on the context menu for the source model. To escape from cursor 'selection mode' without completing the operation use the 'Esc' key. The connection should appear as follows.</p><div class="figure"><a name="d0e177"></a><p class="title"><b>Figure&nbsp;2.7.&nbsp;Connection</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_connectioncontext.png" alt="Connection"></div></div></div><br class="figure-break"><p>Also shown above is the right click context menu off of the connection with the "Edit Links ..." option selected.</p></div><div class="section" title="1.4.&nbsp;Editing Links"><div class="titlepage"><div><div><h3 class="title"><a name="d0e185"></a>1.4.&nbsp;Editing Links</h3></div></div></div><p>The previous figure showed the context route to the edit dialog. This can also be displayed via the main menu</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Composition</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>Edit Links ...</p></li></ul></div></li></ul></div><div class="figure"><a name="d0e198"></a><p class="title"><b>Figure&nbsp;2.8.&nbsp;Edit Links dialog</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_editlinksdlg.png" alt="Edit Links dialog"></div></div></div><br class="figure-break"><p>To create a link check both a source and target item. This should enable the "Add" button below which, when also clicked, adds a link. Currently added links are shown in the Links view pane as follows.</p><div class="figure"><a name="d0e206"></a><p class="title"><b>Figure&nbsp;2.9.&nbsp;Links added to Connection</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_linksinconnection.png" alt="Links added to Connection"></div></div></div><br class="figure-break"><p>Selecting a link enables the "Remove" button which can be used to remove the link from the connection.</p></div><div class="section" title="1.5.&nbsp;Saving Compositions"><div class="titlepage"><div><div><h3 class="title"><a name="d0e214"></a>1.5.&nbsp;Saving Compositions</h3></div></div></div><p>If a composition is unsaved the title bar will appear as follows</p><div class="figure"><a name="d0e219"></a><p class="title"><b>Figure&nbsp;2.10.&nbsp;Unsaved Composition</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_unsavedcomposition.png" alt="Unsaved Composition"></div></div></div><br class="figure-break"><p>Compositions are saved to files with the '.opr' extension. The highlighted text '[?.opr]' shows the model is unsaved and if the application is closed any work will be lost. Use the File menu to save the file. Whenever a '*' appears in the title bar then the composition contains unsaved changes.</p></div><div class="section" title="1.6.&nbsp;Running Compositions"><div class="titlepage"><div><div><h3 class="title"><a name="d0e227"></a>1.6.&nbsp;Running Compositions</h3></div></div></div><p>Use the main menu item</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Composition</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>Run ... F5</p></li></ul></div></li></ul></div><p>To open the run dialog</p><div class="figure"><a name="d0e242"></a><p class="title"><b>Figure&nbsp;2.11.&nbsp;Run Dialog</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_rundlg.png" alt="Run Dialog"></div></div></div><br class="figure-break"><p>The main table has a row for each model in the composition. Pressing run button results in following.</p><div class="figure"><a name="d0e250"></a><p class="title"><b>Figure&nbsp;2.12.&nbsp;Run in progress</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_runinprogress.png" alt="Run in progress"></div></div></div><p><br class="figure-break"></p><p>The "Run" button changes to "Abort" to allow the user to terminate a run before it has been completed. Progress is shown by progress bar, text percentage and values within the grid. The grid columns refer too</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Component</p><p>The name of the Model</p></li><li class="listitem"><p>Status</p><p>The last status event change by the component</p></li><li class="listitem"><p>Progress</p><p>The percentage progress of the component with respect to its own time horizon</p></li><li class="listitem"><p>Last event updated</p><p>The actual time the last event change occurred. Useful for indicating progress of large slow computations.</p></li><li class="listitem"><p>Events</p><p>The current total number of events monitored</p></li></ul></div><p>On successful completion</p><div class="figure"><a name="d0e286"></a><p class="title"><b>Figure&nbsp;2.13.&nbsp;Run completed</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_runcompleted.png" alt="Run completed"></div></div></div><br class="figure-break"><p>The "Run/Abort" button has now changed to "Reload" which allows a user to reload the composition so another run can immediately be executed.</p><p>For a successful run the model component with trigger attached must have reached 100%. However, it is not necessary for all the other models to have reached 100% as the pull driven approach only progress those models as far as necessary to satisfy the successful completion of the triggered component.</p><p>If the run fails; the text in the bottom left corner of the dialog gives information indicating this.</p><p>The status change information that appear in the table during the run are also written to a log. This log can be viewed from the main menu</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>View</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>Log Ctrl+L</p></li></ul></div></li></ul></div><p>This opens</p><div class="figure"><a name="d0e310"></a><p class="title"><b>Figure&nbsp;2.14.&nbsp;Run log</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_runlog.png" alt="Run log"></div></div></div><br class="figure-break"><p>The contents of this grid can be selected and pasted into the users clipboard.</p></div></div><div class="section" title="2.&nbsp;Adapted sources"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e318"></a>2.&nbsp;Adapted sources</h2></div></div></div><p>"Adapted sources" are source exchange items that have been modified. They replace "Data Operations" which were used in version 1 of the OpenMI standard. They can be used to modify an existing source to modify either its spatial or temporal values before they are passed through the link to the target.</p><p>A very simple example of a adapted source is a Linear equation, i.e. an equation that modifies provided values according to the equation y = A*x + B where A and B are user adjustable coefficients.</p><p>Looking at the link dialog from the previous dialog</p><div class="figure"><a name="d0e327"></a><p class="title"><b>Figure&nbsp;2.15.&nbsp;Connection Dialog</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_adapted1_1.png" alt="Connection Dialog"></div></div></div><br class="figure-break"><p>The dialog above shows the "Add Sources ..." button highlighted. As the tool-tip indicates, this will only be active if you have ticked both a source and target exchange item. Clicking this button will produce the following dialog.</p><div class="figure"><a name="d0e335"></a><p class="title"><b>Figure&nbsp;2.16.&nbsp;Add Sources Dialog</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_adapted1_2.png" alt="Add Sources Dialog"></div></div></div><br class="figure-break"><p>This dialog shows the available sources that can be chosen to adapt the current ticked source =&gt; target pair. Source adapters are accessed from dll's (assemblies) that implement the appropriate OpenMI standard interfaces. Collectively these different dll's of source adapters are referred to as factories since they create source adapters based on the source and target. The implementer of the source model can provide access to 'recommended' factories and by default the above dialog defaults to the first recommended factory of the source model; other composition model factories are also loaded into the drop down combo box. So for the example of a composition with two simple river models (same component but different models) the drop down combo could as follows.</p><div class="figure"><a name="d0e343"></a><p class="title"><b>Figure&nbsp;2.17.&nbsp;Preloaded factories from composition</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_adapted1_5.png" alt="Preloaded factories from composition"></div></div></div><br class="figure-break"><p>Here both models in the composition have two factories with identical Ids Factory1 and Factory2, hence, the ids are also prefixed with the model id. It is possible that the model ids might also not be unique, so further information can be obtained by selecting the factory in question and clicking on the "Details ..." button.</p><p>The user is not restricted to using composition loaded factories, third party factories can also be added (see later).</p><p>In the example shown above; the first source recommended factory contains only one adapter. If the user ticks this item and then clicks the add button. The dialog is closed and the underlying connection dialog is modified as shown in the following figure (ringed area).</p><div class="figure"><a name="d0e355"></a><p class="title"><b>Figure&nbsp;2.18.&nbsp;Added Source Adapter</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_adapted1_3.png" alt="Added Source Adapter"></div></div></div><br class="figure-break"><p>An additional source has been added, below the source item it adapts. This source can be used, and adapted, in the same way as any other source.</p><p>When an adapted source is ticked the "Edit Args ..." button becomes active; this is shown in the above figure where the buttons tool-tip is also shown. Clicking on this button will allow the user to edit any arguments that are associated with the adapted source. As shown in the next figure.</p><div class="figure"><a name="d0e365"></a><p class="title"><b>Figure&nbsp;2.19.&nbsp;Edit Arguments dialog</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_adapted1_4.png" alt="Edit Arguments dialog"></div></div></div><br class="figure-break"><p>This dialog allows the user to edit argument values. The columns in the table are</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Caption</p><p>The name of the argument</p></li><li class="listitem"><p>Value</p><p>The value that the argument is currently set to. This column is the only editable column and a specific value might not be editable if the argument is specified as "read only".</p></li><li class="listitem"><p>Type</p><p>The type that the value should be convertible into</p><p>i.e. if (as in this case) the type is "System.Double" the value must be in a valid format to convert into a double.</p></li><li class="listitem"><p>Default</p><p>The default value for this argument.</p></li><li class="listitem"><p>Description</p><p>Further information about the argument.</p></li></ul></div><div class="section" title="2.1.&nbsp;Third party factories"><div class="titlepage"><div><div><h3 class="title"><a name="d0e401"></a>2.1.&nbsp;Third party factories</h3></div></div></div><p>As mentioned earlier, the user is not restricted to using composition loaded factories, third party factories can also be added.</p><p>In the "Add Sources ..." dialog, click on the "..." button to open a "Open File" dialog. Use this to search for either a dll or exe file that implement adapter factories.</p></div></div><div class="section" title="3.&nbsp;Examples"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e408"></a>3.&nbsp;Examples</h2></div></div></div><p>On installation, there is an option to install examples</p><div class="figure"><a name="d0e413"></a><p class="title"><b>Figure&nbsp;2.20.&nbsp;Examples Installer</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_examples_1.png" alt="Examples Installer"></div></div></div><br class="figure-break"><p>If you do not select the ''Entire feature will be unavailable" option above, the examples will also be installed. They can be found under the Help menu.</p><div class="figure"><a name="d0e421"></a><p class="title"><b>Figure&nbsp;2.21.&nbsp;Examples location</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_examples_2.png" alt="Examples location"></div></div></div><br class="figure-break"><p>The examples are actually installed in the examples folder</p><div class="figure"><a name="d0e429"></a><p class="title"><b>Figure&nbsp;2.22.&nbsp;Examples location</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_examples_5.png" alt="Examples location"></div></div></div><br class="figure-break"><p>With the corresponding models and data in the models folder.</p><div class="figure"><a name="d0e437"></a><p class="title"><b>Figure&nbsp;2.23.&nbsp;Models</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_examples_6.png" alt="Models"></div></div></div><br class="figure-break"><p>The Oatc_OpenMI_Examples_SimpleCSharp2.exe source code can be found on the OpenMI source forge site</p><div class="figure"><a name="d0e445"></a><p class="title"><b>Figure&nbsp;2.24.&nbsp;Source forge site</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_examples_7.png" alt="Source forge site"></div></div></div><br class="figure-break"><p>It models a simple river reach with a polyline. Inflow velocities are allowed on the polyline nodes (targets) and channel flows can be extracted from the polyline line segments (sources). The geometry (element sets) is defined in the model data file SimpleCSharpRiver2_RiverReach1.txt which contains</p><div class="figure"><a name="d0e453"></a><p class="title"><b>Figure&nbsp;2.25.&nbsp;SimpleCSharpRiver2_RiverReach1.txt</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_examples_9.png" alt="SimpleCSharpRiver2_RiverReach1.txt"></div></div></div><br class="figure-break"><p>Which will appear in the editor as</p><div class="figure"><a name="d0e461"></a><p class="title"><b>Figure&nbsp;2.26.&nbsp;River Reach Model Properties</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_examples_8.png" alt="River Reach Model Properties"></div></div></div><br class="figure-break"><p>To run this model, one additional file is needed, which provides the boundary conditions SimpleCSharpRiver2_BoundaryConditions1.txt</p><div class="figure"><a name="d0e469"></a><p class="title"><b>Figure&nbsp;2.27.&nbsp;&nbsp;SimpleCSharpRiver2_BoundaryConditions1.txt</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_examples_10.png" alt="&nbsp;SimpleCSharpRiver2_BoundaryConditions1.txt"></div></div></div><br class="figure-break"><div class="section" title="3.1.&nbsp;One river reach"><div class="titlepage"><div><div><h3 class="title"><a name="d0e475"></a>3.1.&nbsp;One river reach</h3></div></div></div><div class="figure"><a name="d0e478"></a><p class="title"><b>Figure&nbsp;2.28.&nbsp;One river reach</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_examples_3.png" alt="One river reach"></div></div></div><br class="figure-break"><p>The loaded composition above is from SimpleCSharpRiver2_RiverReach1.opr</p><div class="figure"><a name="d0e486"></a><p class="title"><b>Figure&nbsp;2.29.&nbsp;SimpleCSharpRiver2_RiverReach1.opr</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_examples_15.png" alt="SimpleCSharpRiver2_RiverReach1.opr"></div></div></div><br class="figure-break"><p>Which references an OpenMI omi file for the model in question SimpleCSharpRiver2_RiverReach1.omi</p><div class="figure"><a name="d0e494"></a><p class="title"><b>Figure&nbsp;2.30.&nbsp;SimpleCSharpRiver2_RiverReach1.omi</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_examples_16.png" alt="SimpleCSharpRiver2_RiverReach1.omi"></div></div></div><br class="figure-break"><p>In this file are listed values specific to the model in question, this example defines the location of the input and output files used and generated during a run.</p><p>This very simple composition consists of only one river reach model. Although we are running it using OpenMI there are no OpenMI connections. Running it produces a results file</p><div class="figure"><a name="d0e504"></a><p class="title"><b>Figure&nbsp;2.31.&nbsp;SimpleCSharpRiver2_RiverReach1.out</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_examples_11.png" alt="SimpleCSharpRiver2_RiverReach1.out"></div></div></div><br class="figure-break"><p>The lines starting with "Section:" show the flow rates after each time step. The time step is a constant 86400 s (1 day) and is specified in the SimpleCSharpRiver2_BoundaryConditions1.txt file. So we can see that this run for 6 days duration. The values are volume flow rates [litres/s]. Section refers to each line segment in the reaches polyline, so there are three values. Leakage is also along the section, again 3 values. The Boundary conditions indicate the flow in at each node (4 along the polyline), these values are also specified in the SimpleCSharpRiver2_BoundaryConditions1.txt file. The OpenMI values are also inflows</p><p>The last line in this file shows a volume balance. As the model is not connected to anything else there is no OpenMI contribution and the inflows should equal the outflows. The leakage is also zero as the leakage coefficient is set to zero in the boundary conditions input file.</p><p>The value 5754240 is obtained by summing the flow rates along the last segment and multiplying by the time step.</p><p>(3.6 + 6.6 + 9.6 + 12.6 + 15.6 + 18.6) * 86400 = 66.6  * 86400 = 575424</p><p>It is often worth testing a new model by running it in stand alone mode first and checking the results. This can often highlight any issues in the OpenMI implementation and also any issues with missing or incorrect model data. Clearly if model data is missing or incorrect; this will give clear indications as to what kind of composition and linkages will be required.</p></div><div class="section" title="3.2.&nbsp;Two river reaches"><div class="titlepage"><div><div><h3 class="title"><a name="d0e520"></a>3.2.&nbsp;Two river reaches</h3></div></div></div><p>Two models of river reaches are added to the composition; both using the same linkable component. </p><div class="figure"><a name="d0e525"></a><p class="title"><b>Figure&nbsp;2.32.&nbsp;Two river reaches</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_examples_12.png" alt="Two river reaches"></div></div></div><br class="figure-break"><p>The corresponding model file (OMI) SimpleCSharpRiver2_RiverReach2.omi contains</p><div class="figure"><a name="d0e533"></a><p class="title"><b>Figure&nbsp;2.33.&nbsp;SimpleCSharpRiver2_RiverReach2.omi</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_examples_17.png" alt="SimpleCSharpRiver2_RiverReach2.omi"></div></div></div><br class="figure-break"><p>From which can be seen that the same boundary conditions file is used as in Reach 1 (same time step, time horizon and default inflows and leakage). The geometry is different, defined in SimpleCSharpRiver2_RiverReach2.txt and there is a different results file SimpleCSharpRiver2_RiverReach2.out.</p><p>The composition contains a single uni-directional link</p><div class="figure"><a name="d0e543"></a><p class="title"><b>Figure&nbsp;2.34.&nbsp;Two river reaches linkage</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_examples_13.png" alt="Two river reaches linkage"></div></div></div><br class="figure-break"><p>Which takes the flow out of the last channel of the first reach and adds it to the first node of the second reach. Effectively joining two river reaches together. Running this composition produces two output files SimpleCSharpRiver2_RiverReach1.out and SimpleCSharpRiver2_RiverReach2.out. SimpleCSharpRiver2_RiverReach1.out will contain the same values as for the stand alone example run (described in previous section) as it is acting as a OpenMI source in this composition i.e. links leave this model but none enter it. However, the downstream reach will be different, looking in SimpleCSharpRiver2_RiverReach2.out</p><div class="figure"><a name="d0e551"></a><p class="title"><b>Figure&nbsp;2.35.&nbsp;SimpleCSharpRiver2_RiverReach2.out</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_examples_14.png" alt="SimpleCSharpRiver2_RiverReach2.out"></div></div></div><br class="figure-break"><p>Reviewing the volume balance (last line). There is now an OpenMI contribution of 4147200 litres which should match the Outflow value in SimpleCSharpRiver2_RiverReach1.out</p><p>The value 147200 is obtained by summing the flow rates along the last segment of  SimpleCSharpRiver2_RiverReach1.out and multiplying by the time step. Note that the last time step value is omitted as this value would be used by reach 2 on iteration 7 (if there had been one). These values are also in SimpleCSharpRiver2_RiverReach2.out; shown as OpenMI inflows.</p><p>(3.6 + 6.6 + 9.6 + 12.6 + 15.6) * 86400 = 48  * 86400 = 4147200</p></div><div class="section" title="3.3.&nbsp;Two reaches + 1 adapter"><div class="titlepage"><div><div><h3 class="title"><a name="d0e563"></a>3.3.&nbsp;Two reaches + 1 adapter</h3></div></div></div><p>This example is the same as the previous example except that the link is replaced with a link with an adapter applied to the source. </p><div class="figure"><a name="d0e568"></a><p class="title"><b>Figure&nbsp;2.36.&nbsp;Two reaches + 1 adapter</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_examples_18.png" alt="Two reaches + 1 adapter"></div></div></div><br class="figure-break"><p>The adapter is a linear equation y = Ax + B where A and B are arguments can be specified by the composition builder. In this example the values are A = 2 and B = 0 which results the reach 1 source values being doubled before being passed onto the reach 2 target. When run SimpleCSharpRiver2_RiverReach2.out contains</p><div class="figure"><a name="d0e576"></a><p class="title"><b>Figure&nbsp;2.37.&nbsp;SimpleCSharpRiver2_RiverReach2.out (with adapter)</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_examples_19.png" alt="SimpleCSharpRiver2_RiverReach2.out (with adapter)"></div></div></div><br class="figure-break"><p>These values are twice those in the previous example.</p></div><div class="section" title="3.4.&nbsp;Two reaches + 2 adapters"><div class="titlepage"><div><div><h3 class="title"><a name="d0e584"></a>3.4.&nbsp;Two reaches + 2 adapters</h3></div></div></div><p>This example is the same as the previous example except that the link is replaced with a link with two adapters applied to the source. </p><div class="figure"><a name="d0e589"></a><p class="title"><b>Figure&nbsp;2.38.&nbsp;Two reaches + 2 adapters</b></p><div class="figure-contents"><div class="mediaobject"><img src="resources/help_examples_20.png" alt="Two reaches + 2 adapters"></div></div></div><br class="figure-break"><p>Both adapters are linear equations y = Ax + B where A and B are arguments can be specified by the composition builder. In this example the values are A = 2 and B = 0 for the first adapter and A = 0.5 and B = 0 for the second adapter. This results in the reach 1 source values being doubled and then halved before being passed onto the reach 2 target. As a consequence the results in SimpleCSharpRiver2_RiverReach2.out will be the same as for the example without any adapters at all.</p><p>The second adapter is different from the first in that the first is obtained from the source factory (reach 1) whilst the second is obtained from a third party factory, Oatc_OpenMI_Sdk_ModelWrapper2.dll </p></div></div></div></div></body></html>